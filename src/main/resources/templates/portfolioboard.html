<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<head>
    <th:block layout:fragment="script">
        <script th:inline="javascript">
            const message = /*[[${msg}]]*/ "";
            if (message) alert(message);
        </script>
    </th:block>
    <style>
        /*      table { width: 100%; border-collapse: collapse; }
              th, td { padding: 8px; border: 1px solid #ccc; }
              th { background: #f0f0f0; }
              .post-actions { margin-bottom: 1rem; }*/
    </style>
</head>
<section layout:fragment="content">
    <body>

    <h1>회원 자유게시판</h1>
    <hr/>

    <table class="post-list-table">
        <thead class="post-list-header">
        <tr>
            <th>ID</th>
            <th>제목</th>
            <th>작성자</th>
            <th>조회수</th>
            <th>작성일</th>
        </tr>
        </thead>
        <tbody class="post-list">
        <tr  th:each="post : ${boardList}">
            <td class="post-list-id" th:text="${post.id}">1</td>
            <td class="post-list-title">
                <a th:href="@{/post/{categoryName}/{id}(categoryName=${post.categoryName}, id=${post.id})}">
                    <span th:text="${post.title}">제목</span>
                    <span th:if="${post.commentCount > 0}"
                          th:text="'(' + ${post.commentCount} + ')'">
                        </span>
                </a>

            </td>
            <td class="post-list-nickname" th:text="${post.userNickname}">닉네임</td>
            <td class="post-list-viewcount" th:text="${post.viewCount}">0</td>
            <td class="post-list-createdAt" th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd HH:mm')}">2025-08-01</td>
        </tr>

        <tr th:if="${#lists.isEmpty(boardList)}">
            <td colspan="6">게시물이 없습니다.</td>
        </tr>
        </tbody>
    </table>
    <hr/>
    <div class="create-post-button">
        <button type="button" th:onclick="|location.href='@{/post/{categoryName}/createpost(categoryName=${categoryName})}'|">
            글쓰기
        </button>
    </div>

    <div class="pagination-wrapper">
        <nav class="pagination">
            <!-- 맨 처음으로 -->
            <a th:if="${currentPage > 0}"
               th:href="@{/post/{category}(page=0, category=${categoryName})}"
               class="pagination-btn">
                첫 페이지
            </a>

            <a th:unless="${currentPage > 0}"
               href="#"
               class="pagination-btn disabled">
                첫 페이지
            </a>


            <!-- 이전 그룹 (5개 이전) -->
            <a th:if="${hasPreviousGroup}"
               th:href="@{/post/{category}(page=${startPage - 1}, category=${categoryName})}"
               class="pagination-btn">
                &laquo;
            </a>
            <a th:unless="${hasPreviousGroup}"
               href="#"
               class="pagination-btn disabled">
                &laquo;
            </a>

            <!-- 이전 버튼 -->
            <a th:if="${hasPrevious}"
               th:href="@{/post/{category}(page=${currentPage - 1}, category=${categoryName})}"
               class="pagination-btn">
                이전
            </a>

            <a th:unless="${hasPrevious}"
               href="#"
               class="pagination-btn disabled">
                이전
            </a>

            <!-- 페이지 번호들 (5개씩) -->
            <th:block th:each="pageNum : ${#numbers.sequence(startPage, endPage)}">
                <a th:class="${pageNum == currentPage} ? 'pagination-btn active' : 'pagination-btn'"
                   th:href="@{/post/{category}(page=${pageNum}, category=${categoryName})}"
                   th:text="${pageNum + 1}">1</a>
            </th:block>

            <!-- 다음 버튼 -->
            <a th:if="${hasNext}"
               th:href="@{/post/{category}(page=${currentPage + 1}, category=${categoryName})}"
               class="pagination-btn">
                다음
            </a>

            <a th:unless="${hasNext}"
               href="#"
               class="pagination-btn disabled">
                다음
            </a>

            <!-- 다음 그룹 (5개 다음) -->
            <a th:if="${hasNextGroup}"
               th:href="@{/post/{category}(page=${endPage + 1}, category=${categoryName})}"
               class="pagination-btn">
                &raquo;
            </a>

            <a th:unless="${hasNextGroup}"
               href="#"
               class="pagination-btn disabled">
                &raquo;
            </a>


            <!-- 맨 마지막으로 -->
            <a th:if="${currentPage < totalPages - 1}"
               th:href="@{/post/{category}(page=${totalPages - 1}, category=${categoryName})}"
               class="pagination-btn">
                마지막 페이지
            </a>
            <a th:unless="${currentPage < totalPages - 1}"
               href="#"
               class="pagination-btn disabled">
                마지막 페이지
            </a>


        </nav>

        <div class="page-info">
            전체 <span th:text="${totalElements}">0</span>개 게시글
            (<span th:text="${currentPage + 1}">1</span> / <span th:text="${totalPages}">1</span> 페이지)
        </div>
    </div>



    </body>
</section>
</html>