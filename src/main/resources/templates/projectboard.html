<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<head>
    <th:block layout:fragment="styles">
        <link rel="stylesheet" th:href="@{/css/projectBoard.css}" />
    </th:block>

    <th:block layout:fragment="script">
        <script th:inline="javascript">
            const message = /*[[${msg}]]*/ "";
            if (message) alert(message);
        </script>
    </th:block>
</head>
<section layout:fragment="content">
    <body>
    <div class="blog-container">
        <!-- 헤더 섹션 -->
        <div class="blog-header">
            <h1>프로젝트</h1>
            <p>프로젝트를 소개합니다</p>
        </div>

        <!-- 글쓰기 버튼 -->
        <div class="create-post-section">
            <button type="button"
                    class="create-post-btn"
                    th:onclick="|location.href='@{/post/{categoryName}/createpost(categoryName=${categoryName})}'|">
                새 프로젝트 작성하기
            </button>
        </div>

        <!-- 포스트 리스트 -->
        <div class="posts-list" th:if="${!#lists.isEmpty(boardList)}">
            <article class="post-item" th:each="post : ${boardList}">
                <!-- 포스트 이미지 영역 -->
                <div class="post-item-image">
                    <!-- 첫 번째 이미지가 있으면 표시, 없으면 기본 그라데이션 -->
                    <img th:if="${post.firstImageUrl != null}"
                         th:src="${post.firstImageUrl}"
                         th:alt="${post.title}"
                         th:onclick="|location.href='@{/post/{categoryName}/{id}(categoryName=${post.categoryName}, id=${post.id})}'|"
                         class="post-thumbnail" />
                    <div th:unless="${post.firstImageUrl != null}"
                         class="post-placeholder"
                         th:onclick="|location.href='@{/post/{categoryName}/{id}(categoryName=${post.categoryName}, id=${post.id})}'|"
                         th:text="${#strings.abbreviate(post.title, 20)}">
                        PROJECT
                    </div>
                </div>

                <div class="post-item-content">
                    <!-- 메타 정보 -->
                    <div class="post-meta" th:onclick="|location.href='@{/post/{categoryName}/{id}(categoryName=${post.categoryName}, id=${post.id})}'|">
                        <span class="post-author" th:text="${post.userNickname}">작성자</span>
                        <span class="post-date" th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd')}">날짜</span>
                        <span class="post-views" th:text="${post.viewCount + '회'}">조회수</span>
                        <span class="comment-count"
                              th:if="${post.commentCount > 0}"
                              th:text="${post.commentCount + '개 댓글'}">
                        </span>
                    </div>

                    <!-- 제목 -->
                    <h2 class="post-item-title">
                        <a th:href="@{/post/{categoryName}/{id}(categoryName=${post.categoryName}, id=${post.id})}"
                           th:text="${post.title}">
                            프로젝트 제목
                        </a>
                    </h2>

                    <!-- 내용 미리보기 -->
                    <!-- 내용 미리보기 -->
                    <div class="post-item-excerpt"
                         th:text="${#strings.length(post.plainContent) > 200 ? #strings.substring(post.plainContent, 0, 200) + '...' : post.plainContent}"
                         th:onclick="|location.href='@{/post/{categoryName}/{id}(categoryName=${post.categoryName}, id=${post.id})}'|">
                        프로젝트에 대한 간단한 설명이 여기에 표시됩니다. 이 프로젝트는 어떤 기술을 사용했고 어떤 문제를 해결했는지에 대한 내용입니다.
                    </div>


                    <!-- 자세히 보기 링크 -->
                    <div class="post-item-footer">
                        <a class="read-more"
                           th:href="@{/post/{categoryName}/{id}(categoryName=${post.categoryName}, id=${post.id})}">
                            자세히 보기 →
                        </a>
                    </div>
                </div>
            </article>
        </div>

        <!-- 게시물이 없을 때 -->
        <div class="no-posts" th:if="${#lists.isEmpty(boardList)}">
            <div class="no-posts-icon">📂</div>
            <h3>아직 프로젝트가 없습니다</h3>
            <p>첫 번째 프로젝트를 공유해보세요!</p>
        </div>

        <!-- 페이지네이션 -->
        <div class="pagination-wrapper">
            <nav class="pagination">
                <!-- 맨 처음으로 -->
                <a th:if="${currentPage > 0}"
                   th:href="@{/post/{category}(page=0, category=${categoryName})}"
                   class="pagination-btn">
                    첫 페이지
                </a>
                <a th:unless="${currentPage > 0}"
                   href="#"
                   class="pagination-btn disabled">
                    첫 페이지
                </a>

                <!-- 이전 그룹 (5개 이전) -->
                <a th:if="${hasPreviousGroup}"
                   th:href="@{/post/{category}(page=${startPage - 1}, category=${categoryName})}"
                   class="pagination-btn">
                    &laquo;
                </a>
                <a th:unless="${hasPreviousGroup}"
                   href="#"
                   class="pagination-btn disabled">
                    &laquo;
                </a>

                <!-- 이전 버튼 -->
                <a th:if="${hasPrevious}"
                   th:href="@{/post/{category}(page=${currentPage - 1}, category=${categoryName})}"
                   class="pagination-btn">
                    이전
                </a>
                <a th:unless="${hasPrevious}"
                   href="#"
                   class="pagination-btn disabled">
                    이전
                </a>

                <!-- 페이지 번호들 (5개씩) -->
                <th:block th:each="pageNum : ${#numbers.sequence(startPage, endPage)}">
                    <a th:class="${pageNum == currentPage} ? 'pagination-btn active' : 'pagination-btn'"
                       th:href="@{/post/{category}(page=${pageNum}, category=${categoryName})}"
                       th:text="${pageNum + 1}">1</a>
                </th:block>

                <!-- 다음 버튼 -->
                <a th:if="${hasNext}"
                   th:href="@{/post/{category}(page=${currentPage + 1}, category=${categoryName})}"
                   class="pagination-btn">
                    다음
                </a>
                <a th:unless="${hasNext}"
                   href="#"
                   class="pagination-btn disabled">
                    다음
                </a>

                <!-- 다음 그룹 (5개 다음) -->
                <a th:if="${hasNextGroup}"
                   th:href="@{/post/{category}(page=${endPage + 1}, category=${categoryName})}"
                   class="pagination-btn">
                    &raquo;
                </a>
                <a th:unless="${hasNextGroup}"
                   href="#"
                   class="pagination-btn disabled">
                    &raquo;
                </a>

                <!-- 맨 마지막으로 -->
                <a th:if="${currentPage < totalPages - 1}"
                   th:href="@{/post/{category}(page=${totalPages - 1}, category=${categoryName})}"
                   class="pagination-btn">
                    마지막 페이지
                </a>
                <a th:unless="${currentPage < totalPages - 1}"
                   href="#"
                   class="pagination-btn disabled">
                    마지막 페이지
                </a>
            </nav>

            <div class="page-info">
                전체 <span th:text="${totalElements}">0</span>개 프로젝트
                (<span th:text="${currentPage + 1}">1</span> / <span th:text="${totalPages}">1</span> 페이지)
            </div>
        </div>
    </div>
    </body>
</section>
</html>